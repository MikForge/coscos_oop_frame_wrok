{"version":3,"sources":["file:///Users/michael/Desktop/gitfiles/coscos_oop_frame_wrok/assets/core/gui/layer/LayerMgr.ts"],"names":["LayerMgr","Node","Camera","LayerType","UIType","enumEntries","LayerUIGameNode","LayerUISceneNode","LayerUIPopUpNode","layerMap","UIGame","UIScene","Scene","PopUp","Notify","Guide","Top","constructor","uiRoot","uiCamera","initLayer","getComponentInChildren","uiFactories","name","n","layerEntries","sort","a","b","Number","layerName","layerTypeValue","layerType","uiType","factory","layerNode","addChild","console","log"],"mappings":"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","sourcesContent":["\nimport { Node, Camera } from \"cc\";\nimport { LayerType, UIType } from \"../../common/enum/ui-layer.enum\";\nimport { enumEntries } from '../../common/enum/utils';\nimport { Fwk } from \"../../Fwks\";\nimport { LayerUIGameNode } from \"./LayerUIGameNode\";\nimport { LayerUISceneNode } from \"./LayerUISceneNode\";\nimport { LayerUIPopUpNode } from \"./LayerUIPopUpNode\";\n\nconst layerMap: Record<LayerType, UIType> = {\n    [LayerType.UIGame]: UIType.UIGame,\n    [LayerType.UIScene]: UIType.Scene,\n    [LayerType.PopUp]: UIType.PopUp,\n    [LayerType.Notify]: UIType.PopUp,\n    [LayerType.Guide]: UIType.PopUp,\n    [LayerType.Top]: UIType.PopUp,\n}\n\nexport class LayerMgr {\n    /** UI 根节点 */\n    uiRoot!: Node;\n    /** UI 摄像机 */\n    uiCamera!: Camera\n\n    constructor() {\n    }\n\n    /** \n     * 初始化 UI节点\n     * @param uiRoot UI 根节点\n     */\n    initLayer(uiRoot: Node): void {\n\n        this.uiRoot = uiRoot;\n\n        this.uiCamera = this.uiRoot.getComponentInChildren(Camera)!;\n\n        // UIType -> factory: 根据具体 UIType 创建不同类型的节点/挂载不同组件\n        const uiFactories: Partial<Record<UIType, (name: string, layerType: LayerType) => Node>> = {\n            [UIType.UIGame]: (name) => {\n                const n = new LayerUIGameNode(name);\n                return n;\n            },\n            [UIType.Scene]: (name) => {\n                const n = new LayerUISceneNode(name);\n                return n;\n            },\n            [UIType.PopUp]: (name) => {\n                const n = new LayerUIPopUpNode(name);\n                return n;\n            },\n        };\n\n        // 按枚举值升序排序后遍历\n        const layerEntries = enumEntries(LayerType).sort((a, b) => Number(a[1]) - Number(b[1]));\n        for (const [layerName, layerTypeValue] of layerEntries) {\n            const layerType = Number(layerTypeValue) as LayerType;\n\n            // 从 layerMap 找到对应的 UIType\n            const uiType = layerMap[layerType];\n\n            // 使用对应 factory 创建节点，若无则退回到默认 new Node\n            const factory = uiFactories[uiType];\n            const layerNode = factory ? factory(layerName, layerType) : new Node(layerName);\n\n            // 将创建的节点加入 uiRoot\n            this.uiRoot.addChild(layerNode);\n\n            console.log(`[LayerMgr] Created layer node: ${layerName} of type ${UIType[uiType]} (LayerType: ${LayerType[layerType]})`);\n        }\n    }\n\n\n}\n"]}